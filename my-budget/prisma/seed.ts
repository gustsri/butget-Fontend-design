import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

async function main() {
  console.log('ðŸŒ± Start Seeding Complete Budget System...')

  // --- 1. CLEANUP (à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸à¹ˆà¸²à¸à¹ˆà¸­à¸™) ---
  await prisma.budgetRecord.deleteMany()
  await prisma.activityFundAllocation.deleteMany()
  await prisma.expenseItemMaster.deleteMany()
  await prisma.budgetCategory.deleteMany()
  await prisma.projectActivity.deleteMany()
  await prisma.strategicPlan.deleteMany()
  await prisma.fundMaster.deleteMany()

  // --- 2. MASTER DATA: FUNDS (à¸à¸­à¸‡à¸—à¸¸à¸™) ---
  console.log('creating funds...')
  const funds = [
    { code: '0100', name: 'à¸à¸­à¸‡à¸—à¸¸à¸™à¸—à¸±à¹ˆà¸§à¹„à¸›' },
    { code: '0200', name: 'à¸à¸­à¸‡à¸—à¸¸à¸™à¹€à¸žà¸·à¹ˆà¸­à¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²' },
    { code: '0300', name: 'à¸à¸­à¸‡à¸—à¸¸à¸™à¸§à¸´à¸ˆà¸±à¸¢' },
    { code: '0400', name: 'à¸à¸­à¸‡à¸—à¸¸à¸™à¸šà¸£à¸´à¸à¸²à¸£à¸§à¸´à¸Šà¸²à¸à¸²à¸£' },
    { code: '0500', name: 'à¸à¸­à¸‡à¸—à¸¸à¸™à¸à¸´à¸ˆà¸à¸²à¸£à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²' },
    { code: '0600', name: 'à¸à¸­à¸‡à¸—à¸¸à¸™à¸ªà¸´à¸™à¸—à¸£à¸±à¸žà¸¢à¹Œà¸–à¸²à¸§à¸£' },
    { code: '0701', name: 'à¸à¸­à¸‡à¸—à¸¸à¸™à¸—à¸³à¸™à¸¸à¸šà¸³à¸£à¸¸à¸‡à¸¨à¸´à¸¥à¸›à¸§à¸±à¸’à¸™à¸˜à¸£à¸£à¸¡' },
    { code: '0702', name: 'à¸à¸­à¸‡à¸—à¸¸à¸™à¸ªà¸³à¸£à¸­à¸‡' },
    { code: '0703', name: 'à¸à¸­à¸‡à¸—à¸¸à¸™à¸žà¸±à¸’à¸™à¸²à¸šà¸¸à¸„à¸¥à¸²à¸à¸£' },
    { code: '0705', name: 'à¸à¸­à¸‡à¸—à¸¸à¸™à¸¢à¸¸à¸—à¸˜à¸¨à¸²à¸ªà¸•à¸£à¹Œ' },
  ]
  for (const f of funds) await prisma.fundMaster.create({ data: f })

  // --- 3. MASTER DATA: CATEGORIES (à¸«à¸¡à¸§à¸”à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢ Level 7) ---
  console.log('creating budget categories...')
  const categories = [
    { code: '51000', name: 'à¸‡à¸šà¸šà¸¸à¸„à¸¥à¸²à¸à¸£' },
    { code: '52000', name: 'à¸‡à¸šà¸”à¸³à¹€à¸™à¸´à¸™à¸‡à¸²à¸™' },
    { code: '53000', name: 'à¸‡à¸šà¸¥à¸‡à¸—à¸¸à¸™' },
    { code: '54000', name: 'à¸‡à¸šà¹€à¸‡à¸´à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™' },
    { code: '55000', name: 'à¸‡à¸šà¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢à¸­à¸·à¹ˆà¸™' },
  ]
  for (const c of categories) await prisma.budgetCategory.create({ data: c })

  // Cache Category IDs for lookup
  const catMap = await prisma.budgetCategory.findMany().then(res =>
    new Map(res.map(c => [c.code, c.id]))
  )

  // --- 4. MASTER DATA: EXPENSE ITEMS (Level 8 - à¸£à¸²à¸¢à¸à¸²à¸£à¸—à¸µà¹ˆà¸à¸¹à¹‰à¸„à¸·à¸™à¸¡à¸²) ---
  console.log('creating expense items...')
  // à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸£à¸²à¸¢à¸à¸²à¸£à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸ˆà¸²à¸à¸—à¸µà¹ˆà¸„à¸¸à¸“à¹ƒà¸«à¹‰à¸¡à¸² (à¸•à¸±à¸”à¸¡à¸²à¹€à¸‰à¸žà¸²à¸° Unique Items)
  const expenseItemsRaw = [
    // 51000
    { code: '51000', name: 'à¸‡à¸šà¸šà¸¸à¸„à¸¥à¸²à¸à¸£', cat: '51000', parent: null },
    { code: '51100', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸šà¸¸à¸„à¸¥à¸²à¸à¸£', cat: '51000', parent: '51000' },
    { code: '5101010000', name: 'à¹€à¸‡à¸´à¸™à¹€à¸”à¸·à¸­à¸™à¹à¸¥à¸°à¸„à¹ˆà¸²à¸ˆà¹‰à¸²à¸‡', cat: '51000', parent: '51100' },
    { code: '5101010017', name: 'à¸„à¹ˆà¸²à¸ˆà¹‰à¸²à¸‡à¸¥à¸¹à¸à¸ˆà¹‰à¸²à¸‡à¸ªà¸±à¸à¸à¸²à¸ˆà¹‰à¸²à¸‡à¸žà¸™à¸±à¸à¸‡à¸²à¸™ (à¸‡à¸šà¸›à¸£à¸°à¸¡à¸²à¸“à¹€à¸‡à¸´à¸™à¸£à¸²à¸¢à¹„à¸”à¹‰)', cat: '51000', parent: '51100' },
    { code: '5101010025', name: 'à¸„à¹ˆà¸²à¸„à¸£à¸­à¸‡à¸Šà¸µà¸žà¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§à¸ªà¸³à¸«à¸£à¸±à¸šà¸žà¸™à¸±à¸à¸‡à¸²à¸™à¹€à¸‡à¸´à¸™à¸£à¸²à¸¢à¹„à¸”à¹‰', cat: '51000', parent: '51100' },
    { code: '5101010038', name: 'à¸„à¹ˆà¸²à¸ˆà¹‰à¸²à¸‡à¸žà¸™à¸±à¸à¸‡à¸²à¸™à¸ªà¸–à¸²à¸šà¸±à¸™à¸›à¸£à¸°à¹€à¸ à¸—à¸žà¸´à¹€à¸¨à¸©', cat: '51000', parent: '51100' },
    { code: '5101010004', name: 'à¹€à¸‡à¸´à¸™à¸›à¸£à¸°à¸ˆà¸³à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸œà¸¹à¹‰à¸šà¸£à¸´à¸«à¸²à¸£', cat: '51000', parent: '51100' },
    { code: '5101010039', name: 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸ à¸²à¸©à¸²à¸•à¹ˆà¸²à¸‡à¸›à¸£à¸°à¹€à¸—à¸¨', cat: '51000', parent: '51100' },
    { code: '51200', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸šà¸¸à¸„à¸¥à¸²à¸à¸£à¸­à¸·à¹ˆà¸™', cat: '51000', parent: '51000' },
    { code: '5101020000', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸šà¸¸à¸„à¸¥à¸²à¸à¸£à¸­à¸·à¹ˆà¸™', cat: '51000', parent: '51200' },
    { code: '5101020051', name: 'à¸„à¹ˆà¸²à¸Šà¸”à¹€à¸Šà¸¢à¸‚à¸­à¸‡à¸žà¸™à¸±à¸à¸‡à¸²à¸™à¸ªà¸–à¸²à¸šà¸±à¸™(à¹€à¸‡à¸´à¸™à¸£à¸²à¸¢à¹„à¸”à¹‰) à¸à¸£à¸“à¸µà¹€à¸¥à¸´à¸à¸ˆà¹‰à¸²à¸‡à¸•à¸²à¸¡à¸«à¸¥à¸±à¸à¹€à¸à¸“à¸‘à¹Œ', cat: '51000', parent: '51200' },
    { code: '5101020045', name: 'à¹€à¸‡à¸´à¸™à¸ªà¸¡à¸—à¸šà¸à¸­à¸‡à¸—à¸¸à¸™à¸ªà¸³à¸£à¸­à¸‡à¹€à¸¥à¸µà¹‰à¸¢à¸‡à¸Šà¸µà¸žà¸žà¸™à¸±à¸à¸‡à¸²à¸™à¸ªà¸–à¸²à¸šà¸±à¸™à¸¯ (à¹€à¸‡à¸´à¸™à¸£à¸²à¸¢à¹„à¸”à¹‰)', cat: '51000', parent: '51200' },
    // 52000
    { code: '52000', name: 'à¸‡à¸šà¸”à¸³à¹€à¸™à¸´à¸™à¸‡à¸²à¸™', cat: '52000', parent: null },
    { code: '52300', name: 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™', cat: '52000', parent: '52000' }, // à¸›à¸£à¸±à¸šà¸ˆà¸²à¸ 52301 à¹€à¸›à¹‡à¸™ 52300 à¹€à¸žà¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡ consistent
    { code: '52301', name: 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™', cat: '52000', parent: '52000' }, // à¹€à¸à¹‡à¸šà¹„à¸§à¹‰à¹€à¸œà¸·à¹ˆà¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸à¹ˆà¸²à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡
    { code: '5230000000', name: 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™à¸­à¸·à¹ˆà¸™', cat: '52000', parent: '52300' },
    { code: '5101010010', name: 'à¸„à¹ˆà¸²à¸¥à¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸²', cat: '52000', parent: '52300' },
    { code: '5104030201', name: 'à¸„à¹ˆà¸²à¹€à¸šà¸µà¹‰à¸¢à¸›à¸£à¸°à¸Šà¸¸à¸¡', cat: '52000', parent: '52300' },
    { code: '5101020014', name: 'à¸„à¹ˆà¸²à¸•à¸£à¸§à¸ˆà¹à¸¥à¸°à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸œà¸¥à¸‡à¸²à¸™à¸—à¸²à¸‡à¸§à¸´à¸Šà¸²à¸à¸²à¸£/à¸›à¸±à¸à¸«à¸²à¸žà¸´à¹€à¸¨à¸©', cat: '52000', parent: '52300' },
    { code: '5101020030', name: 'à¸„à¹ˆà¸²à¸à¸£à¸£à¸¡à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸à¸²à¸£à¸ˆà¹‰à¸²à¸‡ à¸„à¸§à¸šà¸„à¸¸à¸¡à¸‡à¸²à¸™à¹à¸¥à¸°à¸„à¹ˆà¸²à¸­à¸­à¸à¹à¸šà¸š (à¸šà¸¸à¸„à¸„à¸¥à¸ à¸²à¸¢à¹ƒà¸™)', cat: '52000', parent: '52300' },
    { code: '52400', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ªà¸­à¸¢', cat: '52000', parent: '52000' },
    { code: '5104010200', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ªà¸­à¸¢', cat: '52000', parent: '52400' },
    { code: '5104010202', name: 'à¸„à¹ˆà¸²à¸£à¸±à¸šà¸£à¸­à¸‡à¹à¸¥à¸°à¸žà¸´à¸˜à¸µà¸à¸²à¸£', cat: '52000', parent: '52400' },
    { code: '5104010203', name: 'à¸„à¹ˆà¸²à¸ˆà¹‰à¸²à¸‡à¹€à¸«à¸¡à¸²à¸šà¸£à¸´à¸à¸²à¸£', cat: '52000', parent: '52400' },
    { code: '5104010208', name: 'à¸„à¹ˆà¸²à¹€à¸Šà¹ˆà¸²à¸—à¸£à¸±à¸žà¸¢à¹Œà¸ªà¸´à¸™', cat: '52000', parent: '52400' },
    { code: '5104030203', name: 'à¸„à¹ˆà¸²à¹€à¸šà¸µà¹‰à¸¢à¸›à¸£à¸°à¸à¸±à¸™à¸ à¸±à¸¢ (à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¸­à¸²à¸„à¸²à¸£-à¸£à¸–à¸¢à¸™à¸•à¹Œ)', cat: '52000', parent: '52400' },
    { code: '5104010201', name: 'à¸„à¹ˆà¸²à¸˜à¸£à¸£à¸¡à¹€à¸™à¸µà¸¢à¸¡ (à¸ à¸²à¸©à¸µà¸£à¸–à¸¢à¸™à¸•à¹Œ à¸•à¸£à¸§à¸ˆà¸ªà¸ à¸²à¸žà¸›à¸£à¸°à¸ˆà¸³à¸›à¸µ à¸¯à¸¥à¸¯)', cat: '52000', parent: '52400' },
    { code: '5103010000', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹€à¸”à¸´à¸™à¸—à¸²à¸‡à¹€à¸žà¸·à¹ˆà¸­à¸‡à¸²à¸™à¸£à¸²à¸Šà¸à¸²à¸£à¹ƒà¸™à¸›à¸£à¸°à¹€à¸—à¸¨', cat: '52000', parent: '52400' },
    { code: '5104030100', name: 'à¸„à¹ˆà¸²à¸›à¸£à¸°à¸Šà¸²à¸ªà¸±à¸¡à¸žà¸±à¸™à¸˜à¹Œà¹à¸¥à¸°à¸„à¹ˆà¸²à¸žà¸´à¸¡à¸žà¹Œ', cat: '52000', parent: '52400' },
    { code: '52500', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸', cat: '52000', parent: '52000' },
    { code: '5104010000', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¹ƒà¸Šà¹‰à¹„à¸›', cat: '52000', parent: '52500' },
    { code: '5104010101', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¸ªà¸³à¸™à¸±à¸à¸‡à¸²à¸™à¹ƒà¸Šà¹‰à¹„à¸›', cat: '52000', parent: '52500' },
    { code: '5104010102', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¹‚à¸†à¸©à¸“à¸²à¹à¸¥à¸°à¹€à¸œà¸¢à¹à¸žà¸£à¹ˆà¹ƒà¸Šà¹‰à¹„à¸›', cat: '52000', parent: '52500' },
    { code: '5104010104', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¸™à¹‰à¸³à¸¡à¸±à¸™à¹€à¸Šà¸·à¹‰à¸­à¹€à¸žà¸¥à¸´à¸‡à¹à¸¥à¸°à¸«à¸¥à¹ˆà¸­à¸¥à¸·à¹ˆà¸™', cat: '52000', parent: '52500' },
    { code: '5104010105', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¸‡à¸²à¸™à¸šà¹‰à¸²à¸™à¸‡à¸²à¸™à¸„à¸£à¸±à¸§à¹ƒà¸Šà¹‰à¹„à¸›', cat: '52000', parent: '52500' },
    { code: '5104010106', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¸à¹ˆà¸­à¸ªà¸£à¹‰à¸²à¸‡à¹à¸¥à¸°à¸›à¸£à¸°à¸›à¸²', cat: '52000', parent: '52500' },
    { code: '5104010109', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¸„à¸­à¸¡à¸žà¸´à¸§à¹€à¸•à¸­à¸£à¹Œà¹à¸¥à¸°à¸­à¸´à¹€à¸¥à¹‡à¸à¸—à¸£à¸­à¸™à¸´à¸à¸ªà¹Œà¹ƒà¸Šà¹‰à¹„à¸›', cat: '52000', parent: '52500' },
    { code: '5104010111', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¹„à¸Ÿà¸Ÿà¹‰à¸²à¹à¸¥à¸°à¸§à¸´à¸—à¸¢à¸¸', cat: '52000', parent: '52500' },
    { code: '5104010112', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¸à¸²à¸£à¹€à¸à¸©à¸•à¸£', cat: '52000', parent: '52500' },
    { code: '5104010114', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¹à¸•à¹ˆà¸‡à¸à¸²à¸¢', cat: '52000', parent: '52500' },
    { code: '5104010110', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­ à¸§à¸²à¸£à¸ªà¸²à¸£ à¹à¸¥à¸°à¸•à¸³à¸£à¸²', cat: '52000', parent: '52500' },
    { code: '5104010103', name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸à¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²à¹ƒà¸Šà¹‰à¹„à¸›', cat: '52000', parent: '52500' },
    { code: '52600', name: 'à¸„à¹ˆà¸²à¸ªà¸²à¸˜à¸²à¸£à¸“à¸¹à¸›à¹‚à¸ à¸„', cat: '52000', parent: '52000' },
    { code: '5104020000', name: 'à¸„à¹ˆà¸²à¸ªà¸²à¸˜à¸²à¸£à¸“à¸¹à¸›à¹‚à¸ à¸„', cat: '52000', parent: '52600' },
    { code: '5104020001', name: 'à¸„à¹ˆà¸²à¹„à¸Ÿà¸Ÿà¹‰à¸²à¸ªà¸³à¸«à¸£à¸±à¸šà¹ƒà¸Šà¹‰à¸‡à¸²à¸™', cat: '52000', parent: '52600' },
    { code: '5104020003', name: 'à¸„à¹ˆà¸²à¸™à¹‰à¸³à¸›à¸£à¸°à¸›à¸²à¸ªà¸³à¸«à¸£à¸±à¸šà¹ƒà¸Šà¹‰à¸‡à¸²à¸™', cat: '52000', parent: '52600' },
    { code: '5104020005', name: 'à¸„à¹ˆà¸²à¹‚à¸—à¸£à¸¨à¸±à¸žà¸—à¹Œà¸ªà¸³à¸«à¸£à¸±à¸šà¹ƒà¸Šà¹‰à¸‡à¸²à¸™', cat: '52000', parent: '52600' },
    { code: '5104020008', name: 'à¸„à¹ˆà¸²à¹„à¸›à¸£à¸©à¸“à¸µà¸¢à¹Œà¹à¸¥à¸°à¹‚à¸—à¸£à¸ªà¸²à¸£', cat: '52000', parent: '52600' },
    // 53000
    { code: '53000', name: 'à¸‡à¸šà¸¥à¸‡à¸—à¸¸à¸™', cat: '53000', parent: null },
    { code: '53100', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸‡à¸šà¸¥à¸‡à¸—à¸¸à¸™', cat: '53000', parent: '53000' },
    { code: '5411000000', name: 'à¸­à¸²à¸„à¸²à¸£à¹à¸¥à¸°à¸ªà¸´à¹ˆà¸‡à¸à¹ˆà¸­à¸ªà¸£à¹‰à¸²à¸‡', cat: '53000', parent: '53100' },
    { code: '5411000004', name: 'à¸ªà¸´à¹ˆà¸‡à¸à¹ˆà¸­à¸ªà¸£à¹‰à¸²à¸‡', cat: '53000', parent: '5411000000' },
    { code: '5412000000', name: 'à¸„à¸£à¸¸à¸ à¸±à¸“à¸‘à¹Œ', cat: '53000', parent: '53100' },
    { code: '5412000002', name: 'à¸„à¹ˆà¸²à¸„à¸£à¸¸à¸ à¸±à¸“à¸‘à¹Œ', cat: '53000', parent: '5412000000' },
    { code: '5412000003', name: 'à¸„à¹ˆà¸²à¸„à¸£à¸¸à¸ à¸±à¸“à¸‘à¹Œà¸„à¸­à¸¡à¸žà¸´à¸§à¹€à¸•à¸­à¸£à¹Œ', cat: '53000', parent: '5412000000' },
    // 54000
    { code: '54000', name: 'à¸‡à¸šà¹€à¸‡à¸´à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™', cat: '54000', parent: null },
    { code: '54100', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸‡à¸šà¹€à¸‡à¸´à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™', cat: '54000', parent: '54000' },
    { code: '5107010000', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹€à¸‡à¸´à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™-à¹€à¸žà¸·à¹ˆà¸­à¸à¸²à¸£à¸”à¸³à¹€à¸™à¸´à¸™à¸‡à¸²à¸™', cat: '54000', parent: '54100' },
    { code: '5107010045', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹€à¸‡à¸´à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™à¹€à¸ˆà¸£à¸ˆà¸²à¸˜à¸¸à¸£à¸à¸´à¸ˆ', cat: '54000', parent: '54100' },
    { code: '5107010500', name: 'à¹€à¸‡à¸´à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¸¢à¸¸à¸—à¸˜à¸¨à¸²à¸ªà¸•à¸£à¹Œ', cat: '54000', parent: '54100' },
    { code: '5107010501', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸”à¸³à¹€à¸™à¸´à¸™à¸‡à¸²à¸™ : à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¸¢à¸¸à¸—à¸˜à¸¨à¸²à¸ªà¸•à¸£à¹Œ', cat: '54000', parent: '5107010500' },
    { code: '5107010502', name: 'à¸„à¹ˆà¸²à¸„à¸£à¸¸à¸ à¸±à¸“à¸‘à¹Œ : à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¸¢à¸¸à¸—à¸˜à¸¨à¸²à¸ªà¸•à¸£à¹Œ', cat: '54000', parent: '5107010500' },
    { code: '5107010503', name: 'à¸ªà¸´à¹ˆà¸‡à¸à¹ˆà¸­à¸ªà¸£à¹‰à¸²à¸‡ : à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¸¢à¸¸à¸—à¸˜à¸¨à¸²à¸ªà¸•à¸£à¹Œ', cat: '54000', parent: '5107010500' },
    { code: '5107010022', name: 'à¹€à¸‡à¸´à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™à¸—à¸¸à¸™à¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²', cat: '54000', parent: '54100' },
    { code: '5107010088', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹€à¸‡à¸´à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¹à¸¥à¸à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²à¸™à¸²à¸™à¸²à¸Šà¸²à¸•à¸´', cat: '54000', parent: '54100' },
    { code: '5107010021', name: 'à¸—à¸¸à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™à¸à¸²à¸£à¹€à¸”à¸´à¸™à¸—à¸²à¸‡à¹„à¸›à¹€à¸ªà¸™à¸­à¸šà¸—à¸„à¸§à¸²à¸¡à¸—à¸²à¸‡à¸§à¸´à¸Šà¸²à¸à¸²à¸£', cat: '54000', parent: '54100' },
    { code: '5107030003', name: 'à¸—à¸¸à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™à¸à¸²à¸£à¸—à¸³à¸§à¸´à¸—à¸¢à¸²à¸™à¸´à¸žà¸™à¸˜à¹Œà¸‚à¸­à¸‡à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²', cat: '54000', parent: '54100' },
    { code: '5107010201', name: 'à¸—à¸¸à¸™à¸­à¸¸à¸”à¸«à¸™à¸¸à¸™à¸à¸²à¸£à¸—à¸³à¸§à¸´à¸ˆà¸±à¸¢', cat: '54000', parent: '54100' },
    // 55000
    { code: '55000', name: 'à¸‡à¸šà¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢à¸­à¸·à¹ˆà¸™', cat: '55000', parent: null },
    { code: '55100', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸­à¸·à¹ˆà¸™', cat: '55000', parent: '55000' },
    { code: '5108000000', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸­à¸·à¹ˆà¸™', cat: '55000', parent: '55100' },
    { code: '5108000020', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹ƒà¸™à¸à¸²à¸£à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸žà¸´à¹€à¸¨à¸©à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢à¸­à¸·à¹ˆà¸™', cat: '55000', parent: '55100' },
    { code: '5108000024', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹ƒà¸™à¸à¸²à¸£à¸šà¸£à¸´à¸«à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¸à¸¥à¸²à¸‡', cat: '55000', parent: '55100' },
    { code: '5108000008', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹ƒà¸™à¸à¸²à¸£à¸£à¸±à¸šà¸ªà¸¡à¸±à¸„à¸£à¹à¸¥à¸°à¸ªà¸­à¸šà¸„à¸±à¸”à¹€à¸¥à¸·à¸­à¸à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²à¸›à¸£à¸´à¸à¸à¸²à¸•à¸£à¸µ', cat: '55000', parent: '55100' },
    { code: '5108000018', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²', cat: '55000', parent: '55100' },
    { code: '5108000019', name: 'à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¸žà¸´à¹€à¸¨à¸©à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢à¸­à¸·à¹ˆà¸™', cat: '55000', parent: '55100' },

    // à¸£à¸²à¸¢à¸à¸²à¸£à¹€à¸žà¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ List
    { code: '5101020114', name: 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™à¸­à¸²à¸ˆà¸²à¸£à¸¢à¹Œà¸œà¸¹à¹‰à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£à¸«à¸¥à¸±à¸à¸ªà¸¹à¸•à¸£à¸¯', cat: '52000', parent: '52300' },
    { code: '5101020025', name: 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™à¸à¸²à¸£à¹€à¸ªà¸™à¸­à¸šà¸—à¸„à¸§à¸²à¸¡à¸—à¸²à¸‡à¸§à¸´à¸Šà¸²à¸à¸²à¸£', cat: '52000', parent: '52300' },
    { code: '5101020106', name: 'à¹€à¸‡à¸´à¸™à¸£à¸²à¸‡à¸§à¸±à¸¥à¹ƒà¸«à¹‰à¸à¸±à¸šà¸šà¸¸à¸„à¸¥à¸²à¸à¸£à¸—à¸µà¹ˆà¸—à¸³à¸Šà¸·à¹ˆà¸­à¹€à¸ªà¸µà¸¢à¸‡', cat: '52000', parent: '52300' },
    { code: '5101020011', name: 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™à¸§à¸´à¸—à¸¢à¸²à¸à¸£', cat: '52000', parent: '52300' },
    { code: '5101020012', name: 'à¸„à¹ˆà¸²à¸ªà¸­à¸™à¸žà¸´à¹€à¸¨à¸©à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²à¸£à¸°à¸”à¸±à¸šà¸›à¸£à¸´à¸à¸à¸²à¸•à¸£à¸µ', cat: '52000', parent: '52300' },
    { code: '5101020026', name: 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™à¸­à¸²à¸ˆà¸²à¸£à¸¢à¹Œà¸—à¸µà¹ˆà¸›à¸£à¸¶à¸à¸©à¸²', cat: '52000', parent: '52300' },
    { code: '5101020037', name: 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²à¸Šà¹ˆà¸§à¸¢à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸‡à¸²à¸™', cat: '52000', parent: '52300' },
    { code: '5101020013', name: 'à¸„à¹ˆà¸²à¸ªà¸­à¸™à¸žà¸´à¹€à¸¨à¸©à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²à¸£à¸°à¸”à¸±à¸šà¸›à¸£à¸´à¸à¸à¸²à¹‚à¸—-à¹€à¸­à¸', cat: '52000', parent: '52300' },
    { code: '5101020104', name: 'à¸„à¹ˆà¸²à¸•à¸­à¸šà¹à¸—à¸™à¸œà¸¹à¹‰à¸—à¸£à¸‡à¸„à¸¸à¸“à¸§à¸¸à¸’à¸´à¸­à¹ˆà¸²à¸™à¸šà¸—à¸„à¸§à¸²à¸¡à¸§à¸´à¸Šà¸²à¸à¸²à¸£', cat: '52000', parent: '52300' },
    { code: '5104010204', name: 'à¸„à¹ˆà¸²à¸‹à¹ˆà¸­à¸¡à¹à¸‹à¸¡à¹à¸¥à¸°à¸šà¸³à¸£à¸¸à¸‡à¸£à¸±à¸à¸©à¸²à¸„à¸£à¸¸à¸ à¸±à¸“à¸‘à¹Œ', cat: '52000', parent: '52400' },
    { code: '5104010205', name: 'à¸„à¹ˆà¸²à¸‹à¹ˆà¸­à¸¡à¹à¸‹à¸¡à¹à¸¥à¸°à¸šà¸³à¸£à¸¸à¸‡à¸£à¸±à¸à¸©à¸²à¸¢à¸²à¸™à¸žà¸²à¸«à¸™à¸°', cat: '52000', parent: '52400' },
    { code: '5104010206', name: 'à¸„à¹ˆà¸²à¸‹à¹ˆà¸­à¸¡à¹à¸‹à¸¡à¹à¸¥à¸°à¸šà¸³à¸£à¸¸à¸‡à¸£à¸±à¸à¸©à¸²à¸ªà¸´à¹ˆà¸‡à¸à¹ˆà¸­à¸ªà¸£à¹‰à¸²à¸‡ (MA)', cat: '52000', parent: '52400' },
    { code: '5104010291', name: 'à¸„à¹ˆà¸²à¸¥à¸´à¸‚à¸ªà¸´à¸—à¸˜à¸´à¹Œ à¸‹à¸­à¸Ÿà¹à¸§à¸£à¹Œ', cat: '52000', parent: '52400' },
    { code: '5104010214', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹ƒà¸™à¸à¸²à¸£à¸ˆà¸±à¸”à¸­à¸šà¸£à¸¡à¸‚à¸­à¸‡à¸«à¸™à¹ˆà¸§à¸¢à¸‡à¸²à¸™', cat: '52000', parent: '52400' },
    { code: '5104010285', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹ƒà¸™à¸à¸²à¸£à¸•à¸µà¸žà¸´à¸¡à¸žà¹Œà¸šà¸—à¸„à¸§à¸²à¸¡', cat: '52000', parent: '52400' },
    { code: '5104010207', name: 'à¸„à¹ˆà¸²à¸ªà¸¡à¸²à¸Šà¸´à¸à¹à¸¥à¸°à¸à¸²à¸£à¹à¸‚à¹ˆà¸‡à¸‚à¸±à¸™', cat: '52000', parent: '52400' },
    { code: '5104010209', name: 'à¸„à¹ˆà¸²à¸—à¸µà¹ˆà¸žà¸±à¸ à¸­.à¸žà¸´à¹€à¸¨à¸©/à¸œà¸¹à¹‰à¹€à¸Šà¸µà¹ˆà¸¢à¸§à¸Šà¸²à¸à¸•à¹ˆà¸²à¸‡à¸›à¸£à¸°à¹€à¸—à¸¨', cat: '52000', parent: '52400' },
    { code: '5104010210', name: 'à¸„à¹ˆà¸²à¹€à¸”à¸´à¸™à¸—à¸²à¸‡ à¸­.à¸žà¸´à¹€à¸¨à¸©/à¸à¸£à¸£à¸¡à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸§à¸´à¸—à¸¢à¸²à¸™à¸´à¸žà¸™à¸˜à¹Œ', cat: '52000', parent: '52400' },
    { code: '5104010218', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹ƒà¸™à¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²à¸”à¸¹à¸‡à¸²à¸™à¹ƒà¸™à¸«à¸¥à¸±à¸à¸ªà¸¹à¸•à¸£à¸šà¸±à¸“à¸‘à¸´à¸•à¸¨à¸¶à¸à¸©à¸²', cat: '52000', parent: '52400' },
    { code: '5102010000', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸”à¹‰à¸²à¸™à¸à¸²à¸£à¸à¸¶à¸à¸­à¸šà¸£à¸¡à¸ à¸²à¸¢à¹ƒà¸™à¸›à¸£à¸°à¹€à¸—à¸¨', cat: '52000', parent: '52400' },
    { code: '5102020000', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸”à¹‰à¸²à¸™à¸à¸²à¸£à¸à¸¶à¸à¸­à¸šà¸£à¸¡à¸•à¹ˆà¸²à¸‡à¸›à¸£à¸°à¹€à¸—à¸¨', cat: '52000', parent: '52400' },
    { code: '5103020000', name: 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹€à¸”à¸´à¸™à¸—à¸²à¸‡à¹€à¸žà¸·à¹ˆà¸­à¸‡à¸²à¸™à¸£à¸²à¸Šà¸à¸²à¸£à¸•à¹ˆà¸²à¸‡à¸›à¸£à¸°à¹€à¸—à¸¨', cat: '52000', parent: '52400' },
  ]

  // Insert Parents (Level 7 items and Sub-Groups)
  for (const item of expenseItemsRaw.filter(i => !i.parent)) {
    await prisma.expenseItemMaster.upsert({
      where: { code: item.code },
      update: {},
      create: { code: item.code, name: item.name, category_id: catMap.get(item.cat)!, parent_id: null }
    })
  }

  // Insert Children
  for (const item of expenseItemsRaw.filter(i => i.parent)) {
    const parent = await prisma.expenseItemMaster.findUnique({ where: { code: item.parent! } })
    if (parent) {
      await prisma.expenseItemMaster.upsert({
        where: { code: item.code },
        update: {},
        create: { code: item.code, name: item.name, category_id: catMap.get(item.cat)!, parent_id: parent.id }
      })
    }
  }

  // --- 5. ORGANIZATIONAL STRUCTURE (Level 1-5) ---
  console.log('creating organizational structure...')

  // Level 1: Side
  const side09 = await prisma.strategicPlan.create({ data: { code: '09', name: 'à¸”à¹‰à¸²à¸™à¸à¸²à¸£à¸žà¸±à¸’à¸™à¸²à¸›à¸£à¸°à¸Šà¸²à¸à¸£', level: 1 } })
  const side06 = await prisma.strategicPlan.create({ data: { code: '06', name: 'à¸”à¹‰à¸²à¸™à¸§à¸´à¸—à¸¢à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œà¹à¸¥à¸°à¹€à¸—à¸„à¹‚à¸™à¹‚à¸¥à¸¢à¸µ', level: 1 } })

  // Level 2: Plan
  const plan09007 = await prisma.strategicPlan.create({ data: { code: '09007', name: 'à¹à¸œà¸™à¸‡à¸²à¸™à¸ˆà¸±à¸”à¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²à¸­à¸¸à¸”à¸¡à¸¨à¸¶à¸à¸©à¸²', level: 2, parent_id: side09.id } })
  const plan09010 = await prisma.strategicPlan.create({ data: { code: '09010', name: 'à¹à¸œà¸™à¸‡à¸²à¸™à¸šà¸£à¸´à¸à¸²à¸£à¸§à¸´à¸Šà¸²à¸à¸²à¸£à¹à¸à¹ˆà¸ªà¸±à¸‡à¸„à¸¡', level: 2, parent_id: side09.id } })
  const plan09011 = await prisma.strategicPlan.create({ data: { code: '09011', name: 'à¹à¸œà¸™à¸‡à¸²à¸™à¸¨à¸²à¸ªà¸™à¸² à¸¨à¸´à¸¥à¸›à¸°à¹à¸¥à¸°à¸§à¸±à¸’à¸™à¸˜à¸£à¸£à¸¡', level: 2, parent_id: side09.id } })
  const plan06004 = await prisma.strategicPlan.create({ data: { code: '06004', name: 'à¹à¸œà¸™à¸‡à¸²à¸™à¸§à¸´à¸ˆà¸±à¸¢', level: 2, parent_id: side06.id } })

  // Helper function
  const createAct = async (code: string, name: string, level: number, planId?: number, parentId?: number) => {
    return await prisma.projectActivity.create({
      data: { code, name, level, plan_id: planId, parent_id: parentId }
    })
  }

  // Level 3: Job
  const job0101 = await createAct('0101', 'à¸ªà¸™à¸±à¸šà¸ªà¸™à¸¸à¸™à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²', 3, plan09007.id)
  const job0102 = await createAct('0102', 'à¸ˆà¸±à¸”à¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²à¸”à¹‰à¸²à¸™à¸§à¸´à¸—à¸¢à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œà¹à¸¥à¸°à¹€à¸—à¸„à¹‚à¸™à¹‚à¸¥à¸¢à¸µ', 3, plan09007.id)
  const job0201 = await createAct('0201', 'à¸šà¸£à¸´à¸à¸²à¸£à¸§à¸´à¸Šà¸²à¸à¸²à¸£à¹à¸à¹ˆà¸Šà¸¸à¸¡à¸Šà¸™', 3, plan09010.id)
  const job0301 = await createAct('0301', 'à¸—à¸³à¸™à¸¸à¸šà¸³à¸£à¸¸à¸‡à¸¨à¸´à¸¥à¸›à¸§à¸±à¸’à¸™à¸˜à¸£à¸£à¸¡', 3, plan09011.id)
  const job0401 = await createAct('0401', 'à¸‡à¸²à¸™à¸§à¸´à¸ˆà¸±à¸¢ à¸žà¸±à¸’à¸™à¸²à¹à¸¥à¸°à¸–à¹ˆà¸²à¸¢à¸—à¸­à¸”à¹€à¸—à¸„à¹‚à¸™à¹‚à¸¥à¸¢à¸µ', 3, plan06004.id)

  // Level 4: Secondary Activity
  const act10 = await createAct('10', 'à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸šà¸£à¸´à¸«à¸²à¸£à¸—à¸±à¹ˆà¸§à¹„à¸›', 4, undefined, job0101.id)
  const act11 = await createAct('11', 'à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²à¹à¸¥à¸°à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥', 4, undefined, job0101.id)
  const act13 = await createAct('13', 'à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸šà¸£à¸´à¸à¸²à¸£à¸„à¸­à¸¡à¸žà¸´à¸§à¹€à¸•à¸­à¸£à¹Œà¸—à¸²à¸‡à¸§à¸´à¸Šà¸²à¸à¸²à¸£', 4, undefined, job0101.id)
  const act14 = await createAct('14', 'à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸šà¸£à¸´à¸«à¸²à¸£à¸§à¸´à¸Šà¸²à¸à¸²à¸£', 4, undefined, job0101.id)
  const act15 = await createAct('15', 'à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸žà¸±à¸’à¸™à¸²à¸„à¸¸à¸“à¸ à¸²à¸žà¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²', 4, undefined, job0101.id)
  const act16 = await createAct('16', 'à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸žà¸±à¸’à¸™à¸²à¸šà¸¸à¸„à¸¥à¸²à¸à¸£à¸—à¸²à¸‡à¸§à¸´à¸Šà¸²à¸à¸²à¸£', 4, undefined, job0101.id)
  const act17 = await createAct('17', 'à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸œà¸¥à¸´à¸•à¹à¸¥à¸°à¸žà¸±à¸’à¸™à¸²à¸ªà¸·à¹ˆà¸­à¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²', 4, undefined, job0101.id)
  const act18 = await createAct('18', 'à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸žà¸±à¸’à¸™à¸²à¸«à¸¥à¸±à¸à¸ªà¸¹à¸•à¸£à¹à¸¥à¸°à¸à¸²à¸£à¹€à¸£à¸µà¸¢à¸™à¸à¸²à¸£à¸ªà¸­à¸™', 4, undefined, job0101.id)
  const act19 = await createAct('19', 'à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸ªà¹ˆà¸‡à¹€à¸ªà¸£à¸´à¸¡à¸à¸²à¸£à¸œà¸¥à¸´à¸•à¸•à¸³à¸£à¸²', 4, undefined, job0101.id)

  const act25 = await createAct('25', 'à¸ªà¸²à¸‚à¸²à¹€à¸—à¸„à¹‚à¸™à¹‚à¸¥à¸¢à¸µà¸ªà¸²à¸£à¸ªà¸™à¹€à¸—à¸¨', 4, undefined, job0102.id)

  // Dummy Level 4 for others (to keep structure consistent)
  const act0201_sub = await createAct('0201-1', 'à¸šà¸£à¸´à¸à¸²à¸£à¸§à¸´à¸Šà¸²à¸à¸²à¸£à¹à¸à¹ˆà¸Šà¸¸à¸¡à¸Šà¸™ (à¸¢à¹ˆà¸­à¸¢)', 4, undefined, job0201.id)
  const act0301_sub = await createAct('0301-1', 'à¸—à¸³à¸™à¸¸à¸šà¸³à¸£à¸¸à¸‡à¸¨à¸´à¸¥à¸›à¸§à¸±à¸’à¸™à¸˜à¸£à¸£à¸¡ (à¸¢à¹ˆà¸­à¸¢)', 4, undefined, job0301.id)
  const act0401_sub = await createAct('0401-1', 'à¸‡à¸²à¸™à¸§à¸´à¸ˆà¸±à¸¢ (à¸¢à¹ˆà¸­à¸¢)', 4, undefined, job0401.id)

  // Level 5: Sub-Activity (à¹€à¸‰à¸žà¸²à¸° 25)
  const act25_bachelor = await createAct('25-1', 'à¸£à¸°à¸”à¸±à¸šà¸›à¸£à¸´à¸à¸à¸²à¸•à¸£à¸µ', 5, undefined, act25.id)
  const act25_master = await createAct('25-2', 'à¸£à¸°à¸”à¸±à¸šà¸›à¸£à¸´à¸à¸à¸²à¹‚à¸—-à¹€à¸­à¸', 5, undefined, act25.id)

  // --- 6. MAPPING & RECORDS (Allocation) ---
  console.log('creating allocations...')
  const fundMap = await prisma.fundMaster.findMany().then(res => new Map(res.map(f => [f.code, f.id])))

  const allocate = async (activity: any, fundCode: string, itemCodes: string[]) => {
    const fundId = fundMap.get(fundCode)
    if (!fundId) return
    const alloc = await prisma.activityFundAllocation.upsert({
      where: { activity_id_fund_id: { activity_id: activity.id, fund_id: fundId } },
      update: {},
      create: { activity_id: activity.id, fund_id: fundId }
    })

    // Create Records
    for (const code of itemCodes) {
      const item = await prisma.expenseItemMaster.findUnique({ where: { code } })
      if (item) {
        await prisma.budgetRecord.create({
          data: {
            academic_year: 2569,
            allocation_id: alloc.id,
            item_id: item.id,
            category_id: item.category_id,
            fund_id: fundId,
            amount_budget: 0,
            amount_income: 0
          }
        })
      }
    }
  }

  // --- MAPPING LOGIC (à¸•à¸²à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸„à¸¸à¸“à¹ƒà¸«à¹‰) ---

  // 1. à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸šà¸£à¸´à¸«à¸²à¸£à¸—à¸±à¹ˆà¸§à¹„à¸› (10)
  await allocate(act10, '0100', ['5101010000', '5101010017', '5101010025', '5101010038', '5101010004', '5101010039', '5101020000', '5101020051', '5101020045', '5230000000', '5101010010', '5104030201', '5101020014', '5101020030', '5104010200', '5104010202', '5104010203', '5104010208', '5104030203', '5104010201', '5103010000', '5104030100', '5104010000', '5104010101', '5104010102', '5104010104', '5104010105', '5104010106', '5104010109', '5104010111', '5104010112', '5104010114', '5104020000', '5104020001', '5104020003', '5104020005', '5104020008', '5107010000', '5107010045', '5108000000', '5108000020', '5108000024'])
  await allocate(act10, '0705', ['54100', '5107010500', '5107010501', '5107010502', '5107010503'])
  await allocate(act10, '0600', ['5104010200', '5104010204', '5104010205', '5104010206', '53100', '5411000000', '5411000004', '5412000000', '5412000002', '5412000003'])

  // 2. à¸—à¸°à¹€à¸šà¸µà¸¢à¸™ (11)
  await allocate(act11, '0100', ['5230000000', '5101020019', '5108000000', '5108000008'])
  await allocate(act11, '0705', ['54100', '5107010500', '5107010501'])

  // 3. à¸„à¸­à¸¡à¸žà¸´à¸§à¹€à¸•à¸­à¸£à¹Œ (13)
  await allocate(act13, '0100', ['5104010200', '5104010291'])
  await allocate(act13, '0705', ['54100', '5107010500', '5107010501'])

  // 4. à¸šà¸£à¸´à¸«à¸²à¸£à¸§à¸´à¸Šà¸²à¸à¸²à¸£ (14)
  await allocate(act14, '0200', ['54100', '5107010000', '5107010022'])
  await allocate(act14, '0705', ['54100', '5107010500', '5107010501'])

  // 5. à¸„à¸¸à¸“à¸ à¸²à¸žà¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸² (15)
  await allocate(act15, '0500', ['5230000000', '54100', '5107010000', '5107010088', '5108000000', '5108000018'])
  await allocate(act15, '0705', ['54100', '5107010500', '5107010501'])

  // 6. à¸žà¸±à¸’à¸™à¸²à¸šà¸¸à¸„à¸¥à¸²à¸à¸£ (16)
  await allocate(act16, '0703', ['5230000000', '5101020025', '5101020106', '5104010200', '5102010000', '5102020000', '5103010000', '5103020000', '5104010214', '5104010285', '5107010021'])
  await allocate(act16, '0705', ['54100', '5107010500', '5107010501'])

  // 7. à¸ªà¸·à¹ˆà¸­à¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸² (17)
  await allocate(act17, '0200', ['5104010200', '5104010203'])
  await allocate(act17, '0705', ['54100', '5107010500', '5107010501'])

  // 8. à¸«à¸¥à¸±à¸à¸ªà¸¹à¸•à¸£ (18)
  await allocate(act18, '0200', ['5230000000', '5101020114', '5104010200'])
  await allocate(act18, '0705', ['54100', '5107010500', '5107010501'])

  // 9. à¸•à¸³à¸£à¸² (19)
  await allocate(act19, '0200', ['5230000000', '5104010000', '5104010102', '5104010110'])
  await allocate(act19, '0705', ['54100', '5107010500', '5107010501'])

  // 10. à¸ªà¸²à¸‚à¸²à¹„à¸­à¸—à¸µ (25) -> Map à¸—à¸µà¹ˆ Level 5
  // à¸›.à¸•à¸£à¸µ
  await allocate(act25_bachelor, '0200', ['5230000000', '5101020011', '5101020012', '5101020026', '5101020037', '5104010200', '5104010203', '5104010207', '5104010209', '5104010210', '5104010218', '5104010000', '5104010103'])
  await allocate(act25_bachelor, '0705', ['54100', '5107010500', '5107010501'])
  await allocate(act25_bachelor, '0600', ['53100', '5412000000', '5412000003'])
  // à¸›.à¹‚à¸—
  await allocate(act25_master, '0200', ['5230000000', '5101020013'])

  // 11. à¸šà¸£à¸´à¸à¸²à¸£à¸§à¸´à¸Šà¸²à¸à¸²à¸£ (0201)
  await allocate(act0201_sub, '0400', ['5230000000', '5101020104', '5104010200', '5104010203', '5104010000', '5104010101', '5108000000', '5108000019'])
  await allocate(act0201_sub, '0705', ['54100', '5107010500', '5107010501'])

  // 12. à¸—à¸³à¸™à¸¸à¸šà¸³à¸£à¸¸à¸‡à¸¨à¸´à¸¥à¸›à¹Œ (0301)
  await allocate(act0301_sub, '0701', ['54100', '5107010500', '5107010501', '5108000000', '5108000019'])

  // 13. à¸§à¸´à¸ˆà¸±à¸¢ (0401)
  await allocate(act0401_sub, '0300', ['54100', '5107010000', '5107030003', '5107010201'])
  await allocate(act0401_sub, '0705', ['54100', '5107010500', '5107010501'])

  console.log('âœ… Seeding Completed Successfully!')
}

main()
  .catch((e) => {
    console.error(e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })